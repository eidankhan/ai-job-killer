version: 1
disable_existing_loggers: false

formatters:
  default:
    format: "%(levelprefix)s %(asctime)s | %(name)s | %(message)s"
    datefmt: "%Y-%m-%d %H:%M:%S"
    class: uvicorn.logging.DefaultFormatter
  access:
    format: '%(levelprefix)s %(asctime)s | %(client_addr)s - "%(request_line)s" %(status_code)s'
    datefmt: "%Y-%m-%d %H:%M:%S"
    class: uvicorn.logging.AccessFormatter

handlers:
  default:
    class: logging.StreamHandler
    formatter: default
    stream: ext://sys.stdout
  access:
    class: logging.StreamHandler
    formatter: access
    stream: ext://sys.stdout
  file_app:
    class: logging.handlers.RotatingFileHandler
    formatter: default
    filename: /app/logs/api.log
    maxBytes: 10485760  # 10 MB
    backupCount: 5
    encoding: utf8
  file_access:
    class: logging.handlers.RotatingFileHandler
    formatter: access
    filename: /app/logs/access.log
    maxBytes: 10485760  # 10 MB
    backupCount: 5
    encoding: utf8

loggers:
  uvicorn:
    handlers: [default, file_app]
    level: INFO
  uvicorn.error:
    handlers: [default, file_app]
    level: INFO
    propagate: false
  uvicorn.access:
    handlers: [access, file_access]
    level: INFO
    propagate: false
  fastapi:
    handlers: [default, file_app]
    level: INFO
    propagate: false
  sqlalchemy.engine:
    handlers: [default, file_app]
    level: WARNING
    propagate: false

root:
  handlers: [default, file_app]
  level: INFO
